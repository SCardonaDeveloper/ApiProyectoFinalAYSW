@page "/TipoProducto"

@using System.Net.Http.Json;
@using FrontendBlazorApi.Models;
@inject IHttpClientFactory FabricaHttp;
@page "/TipoProducto"
<PageTitle>Tipos de Productos</PageTitle>
<h3>Gestion de los Productos</h3>
<p>En esta página se gestionan los tipos de productos para consultar, crear, actualizar y borrar desde la API lol</p>
@if(tipoProductos is null){
    <p><em>Cargando tipos de productos...</em></p>
}else if(!tipoProductos.Any()){
    <p>No se han encontrado tipos de productos registrados</p>
}else{
    <table class="table">
    <thead>
    <tr>
    <th>Id</th>
    <th>Nombre</th>
    <th>Descripción</th>
    </tr>
    </thead>
    <tbody>
    @foreach(var p in tipoProductos){
        <tr>
        @* <td>@p.Id</td>
        <td>@p.Nombre</td>
        <td>@p.Descripcion</td> *@
        </tr>
    }
    </tbody>
    </table>
}
@code{
private List<TipoProducto>? tipoProductos;
protected override async Task OnInitializedAsync()
{
    try{
    var cliente = FabricaHttp.CreateClient("ApiProductos");
    var respuesta = await cliente.GetFromJsonAsync<RespuestaApi<List<TipoProducto>>>("api/TipoProducto");
    tipoProductos = respuesta?.Datos ?? new List<TipoProducto>();
    }
    catch (Exception ex){
        Console.WriteLine($"Error al cargar productos: {ex.Message}");
        tipoProductos = new List<TipoProducto>();
    }
 }
}